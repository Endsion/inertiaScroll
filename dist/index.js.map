{
  "version": 3,
  "sources": ["../src/index.ts", "../src/utils/index.ts"],
  "sourcesContent": ["import { throttle } from 'lodash'\nimport { isDOM, compose } from './utils';\nimport { IElProp, Direction, IMouseCoord } from './types'\n// 1 \u5F15\u7528\u7C7B\u578B\n// 2 \u66B4\u9732\u65B9\u6CD5\nlet allowScroll = true; // \u662F\u5426\u5141\u8BB8\u6EDA\u52A8\n\nconst validArea = 100; // \u6709\u6548\u533A\u57DF\u503C \u4E0A\u4E0B px\nconst step = 2; // \u6EDA\u52A8\u901F\u5EA6 px\nlet elProp:IElProp|null = null; // \u5143\u7D20\u5C5E\u6027\nlet mouseIn = false; // \u9F20\u6807\u4F4D\u7F6E\nlet scrolling = false; // \u6EDA\u52A8\u72B6\u6001\nlet currentDirection:Direction = Direction.UP; // \u9F20\u6807\u4F4D\u7F6E\n\nconst rAF = window.requestAnimationFrame || (func => setTimeout(func, 16));\n\nconst setScroll = (scroll:boolean) => {\n  allowScroll = scroll;\n  (!scroll && scrolling) && stopScroll();\n};\n\nconst getElProp = (el: HTMLDivElement) => {\n  const elRect = el.getBoundingClientRect();\n  elProp = {\n    left: elRect.left,\n    top: elRect.top,\n    width: el.clientHeight,\n    height: el.clientHeight,\n    scrollTop: el.scrollTop,\n    scrollHeight: el.scrollHeight\n  };\n};\n\nconst scroll = (el: HTMLDivElement) =>{\n    if(!elProp){\n        return\n    }\n  if (currentDirection === 'up' && elProp.scrollTop > 0) {\n    let currentStep = -step;\n    elProp.scrollTop = elProp.scrollTop + currentStep;\n    el.scrollTop = elProp.scrollTop;\n  }\n  if (currentDirection === 'down' && elProp.scrollTop < elProp.scrollHeight - elProp.height) {\n    let currentStep = step;\n    elProp.scrollTop = elProp.scrollTop + currentStep;\n    el.scrollTop = elProp.scrollTop;\n  }\n  scrolling && rAF(()=>{\n    scroll(el);\n  });\n};\n\nconst startScroll = (direction: Direction, el: HTMLDivElement) =>{\n  currentDirection = direction;\n  if (!scrolling) {\n    scrolling = true;\n    scroll(el);\n  }\n};\n\nconst stopScroll = () =>{\n  scrolling = false;\n};\nconst onMouseLeave = ()=>{\n  mouseIn = false;\n  stopScroll();\n};\nconst onMouseEnter = ()=>{\n  mouseIn = true;\n};\nconst onMouseMove = throttle((event:MouseEvent, el:HTMLDivElement)=>{\n  if (!allowScroll || !mouseIn) {\n    return;\n  }\n\n  const getMouseCoord = ()=> {\n    const e = event || window.event;\n    const curseX = e.pageX;\n    const curseY = e.pageY;\n    return {\n      curseX,\n      curseY\n    };\n  };\n\n  const calcScroll = (mouseCoord:IMouseCoord)=>{\n    let direction = '';\n    if(!elProp){\n        return\n    }\n    const isUp = mouseCoord.curseX > elProp.left && mouseCoord.curseX < (elProp.left + elProp.width) && mouseCoord.curseY > elProp.top && mouseCoord.curseY < elProp.top + validArea;\n    const isDown = mouseCoord.curseX > elProp.left && mouseCoord.curseX < (elProp.left + elProp.width) && mouseCoord.curseY > (elProp.top + elProp.height - validArea) && mouseCoord.curseY < (elProp.top + elProp.height);\n    isUp && (direction = 'up');\n    isDown && (direction = 'down');\n    return {\n      isScroll: isUp || isDown,\n      direction\n    };\n  };\n\n  const toggleScroll = (res:{\n    isScroll: Boolean,\n    direction: Direction\n  }) =>{\n    if (elProp && elProp.scrollHeight < elProp.height) {\n      return;\n    }\n    if (res.isScroll) {\n      startScroll(res.direction, el);\n    }\n    if (!res.isScroll) {\n      stopScroll();\n    }\n  };\n\n  const chains = compose(\n    toggleScroll, // \u6EDA\u52A8\u64CD\u4F5C\n    calcScroll, // \u8BA1\u7B97\u6EDA\u52A8\u65B9\u5F0F \u5411\u4E0A  \u5411\u4E0B \u6216\u8005 \u4E0D\u6EDA\n    getMouseCoord, // \u83B7\u53D6\u9F20\u6807\u5750\u6807\n    getElProp, // el\u5C5E\u6027\u4F1A\u53D8\u5316  \u9700\u8981\u5728mousemove\u4E2D\u5B9E\u65F6\u8C03\u7528\n  );\n\n  chains(el);\n}, 100);\n\nconst initScroll = (el: HTMLDivElement, scroll = true) => {\n  if (!isDOM(el)) {\n    console.error('scroll el must be dom node');\n    return;\n  }\n  allowScroll = scroll;\n  el.addEventListener('mousemove', (e: MouseEvent)=>{\n    onMouseMove(e, el);\n  });\n  el.addEventListener('mouseleave', onMouseLeave);\n  el.addEventListener('mouseenter', onMouseEnter);\n};\n\nconst release = () => {\n  allowScroll = true; // \u662F\u5426\u5141\u8BB8\u6EDA\u52A8\n  elProp = null; // \u5143\u7D20\u5C5E\u6027\n  mouseIn = false; // \u9F20\u6807\u4F4D\u7F6E\n  scrolling = false; // \u6EDA\u52A8\u72B6\u6001\n};\n\nexport {\n  setScroll,\n  initScroll,\n  release\n};\n", "const assert = (type:string):Function => {\n    return (val:any)=>{\n      return typeof val === type;\n    };\n  };\n  \n  const assertFunction = assert('function');\n  const assertNumber = assert('number');\n  \n  const isDOM = typeof HTMLElement === 'object' ? (dom: any) => {\n    return dom instanceof HTMLElement;\n  } : (dom: any) => {\n    return dom && typeof dom === 'object' && dom.nodeType === 1 && typeof \tdom.nodeName === 'string';\n  };\n  \n  const compose = (...funcs:Function[]) => {\n    if (funcs.length === 0) {\n      return (arg:any) => arg;\n    }\n    if (funcs.length === 1) {\n      return funcs[0];\n    }\n    return funcs.reduce((a, b) => (...args:any) => a(b(...args)));\n  };\n  const deepClone = (obj: Object) =>{\n    return JSON.parse(JSON.stringify(obj));\n  };\n   \n  function throttle(fn:Function, delay = 500) {\n    let timer:number|null = null;\n    return (...args) => {\n      if (timer) return;\n      timer = setTimeout(() => {\n        // @ts-ignore\n        fn.apply(this, arguments);\n        timer = null;\n      }, delay);\n    };\n  }\n  \n  export {\n    assertFunction,\n    assertNumber,\n    deepClone,\n    isDOM,\n    compose,\n    throttle\n  };\n  "],
  "mappings": "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",
  "names": ["scroll"]
}
